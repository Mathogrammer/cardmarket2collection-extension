$(function(){$.urlParam=function(e){var n=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.search);return null!==n&&(n[1]||0)},"true"===$.urlParam("evaluate")&&document.getElementById("OpenEvaluationModal")&&document.getElementById("OpenEvaluationModal").click(),$(document).on("input","#EvaluateShipmentForm :input",function(){OrderDetailsView.checkEvaluationForm($(this).closest("#EvaluateShipmentForm"))}),$(document).on("submit","#EvaluateShipmentForm",function(){return OrderDetailsView.checkEvaluationForm(this)}),$('.vat-fixed input[type="checkbox"]').change(function(){var e=$("input[name=vatPerc]");this.checked?(e.val(0),e.attr("readonly",!0)):(e.val(""),e.attr("readonly",!1))}),$("select[name=envelopeFormat]").change(function(){0==$(this).val()?($("#collapsibleCustomFormat input").prop("disabled",!1),$("#collapsibleCustomFormat").collapse("show")):($("#collapsibleCustomFormat input").prop("disabled",!0),$("#collapsibleCustomFormat").collapse("hide"))}),$(".edit-memo").click(function(){$("#collapsibleMemo").collapse("show"),$("#collapsibleMemo textarea").focus(),Scroller.goTo("#collapsibleMemo")}),$(".currency-switch").click(function(){OrderDetailsView.switchRefundFormVisibility()}),$(".refund-input").find('input[name="amount"]').keyup(function(){OrderDetailsView.delayedInputCallback(this)})});var OrderDetailsView={typingTimer:0,doneTypingInterval:500,checkEvaluationForm:function(e){if($(e).find("select[name=evaluationGrade]").val()>1){var n=$(e).find("input[name=comment]").val(),t=$(e).find("input[name^=complaint]").map(function(){return this.checked});if(""==n&&-1==$.inArray(!0,t))return $(e).find(".alert-evaluation").show(),$(e).find("input[type=submit]").prop("disabled",!0),!1}return $(e).find(".alert-evaluation").hide(),$(e).find("input[type=submit]").prop("disabled",!1),!0},switchRefundFormVisibility:function(){$(".refund-form").each(function(){$(this).toggleClass("d-none")})},checkAmount:function(e){var n=Number(e.replace(",",".")),t=$('[id^=Refund] input[name="amount"]'),i=Number(t.data("max-amount"));n>0&&n<=i?OrderDetailsView.enableRefundButton():OrderDetailsView.disableRefundButton()},enableRefundButton:function(){$(".refund-submit").each(function(){$(this).hasClass("disabled")&&$(this).toggleClass("disabled")})},disableRefundButton:function(){$(".refund-submit").each(function(){$(this).hasClass("disabled")||$(this).toggleClass("disabled")})},currencyConversionCallback:function(e){var n=e.getB64("senderAmount"),t=e.getB64("receiverAmount");e.getInt("isOwnCurrency")?(ownCurrencyAmount=n,convertedCurrencyAmount=t):(ownCurrencyAmount=t,convertedCurrencyAmount=n),$(".refund-converted:visible").html(convertedCurrencyAmount),$(".refund-converted:hidden").html(ownCurrencyAmount),$('.refund-form input[name="amount"]:hidden').val(convertedCurrencyAmount)},delayedInputCallback:function(e){clearTimeout(OrderDetailsView.typingTimer),OrderDetailsView.typingTimer=setTimeout(OrderDetailsView.executeDelayedCode,OrderDetailsView.doneTypingInterval,e)},executeDelayedCode:function(e){var n=document.querySelector(".refund-ajax-form");if(n){n.amount.value=e.value;var t=e.closest("form").isOwnCurrency.value;n.isOwnCurrency.value=t;var i=new AjaxRequest;i.setFromDomObject(n),i.submitRequest()}OrderDetailsView.checkAmount(e.value)}};